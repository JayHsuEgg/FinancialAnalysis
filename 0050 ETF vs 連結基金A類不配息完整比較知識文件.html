<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>0050 ETF vs é€£çµåŸºé‡‘æ¯”è¼ƒè¨ˆç®—å™¨ - æ”¹é€²ç‰ˆ</title>
    <style>
        * {
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #2c3e50, #3498db);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            margin: 0 0 10px 0;
            font-size: 2.5em;
            font-weight: 300;
        }
        
        .header p {
            margin: 0;
            opacity: 0.9;
        }
        
        .content {
            padding: 30px;
        }
        
        .input-section {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 30px;
            border: 2px solid #e9ecef;
        }
        
        .input-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
        }
        
        .form-group label {
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 8px;
            font-size: 14px;
        }
        
        .form-group input, .form-group select {
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            transition: all 0.3s ease;
        }
        
        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
        }
        
        .form-group input.error {
            border-color: #e74c3c;
            background-color: #fdf2f2;
        }
        
        .input-hint {
            font-size: 12px;
            color: #666;
            margin-top: 4px;
        }
        
        .error-message {
            background: #f8d7da;
            color: #721c24;
            padding: 12px;
            border-radius: 8px;
            margin: 15px 0;
            border: 1px solid #f5c6cb;
            display: none;
        }
        
        .calculate-btn {
            background: linear-gradient(135deg, #3498db, #2c3e50);
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 50px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
            margin-top: 20px;
            position: relative;
        }
        
        .calculate-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        .calculate-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        
        .loading-spinner {
            display: none;
            width: 20px;
            height: 20px;
            border: 2px solid #ffffff;
            border-top: 2px solid transparent;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 10px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .results {
            display: grid;
            grid-template-columns: 1fr;
            gap: 25px;
            margin-top: 30px;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.5s ease;
        }
        
        .results.show {
            opacity: 1;
            transform: translateY(0);
        }
        
        .result-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            border: 2px solid #e9ecef;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
            transition: transform 0.3s ease;
        }
        
        .result-card:hover {
            transform: translateY(-2px);
        }
        
        .result-card h3 {
            color: #2c3e50;
            margin: 0 0 20px 0;
            font-size: 1.4em;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
        }
        
        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
            font-size: 14px;
        }
        
        .comparison-table th,
        .comparison-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
            word-wrap: break-word;
        }
        
        .comparison-table th {
            background: #f8f9fa;
            font-weight: 600;
            color: #2c3e50;
            position: sticky;
            top: 0;
        }
        
        .comparison-table .winner {
            background: #d4edda;
            color: #155724;
            font-weight: bold;
        }
        
        .highlight {
            background: linear-gradient(135deg, #74b9ff, #0984e3);
            color: white;
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            text-align: center;
            font-weight: 600;
        }
        
        .tax-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        
        .tax-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            border: 2px solid #e9ecef;
        }
        
        .tax-item h4 {
            margin: 0 0 10px 0;
            color: #2c3e50;
        }
        
        .positive { color: #27ae60; font-weight: bold; }
        .negative { color: #e74c3c; font-weight: bold; }
        
        /* highlight å€å¡Šå…§çš„ positive æ–‡å­—ä½¿ç”¨æ›´æ˜é¡¯çš„é¡è‰² */
        .highlight .positive { color: #ffeb3b; font-weight: bold; }
        
        .calculation-step {
            background: #f8f9fa;
            border-left: 4px solid #3498db;
            padding: 20px;
            margin: 15px 0;
            border-radius: 0 8px 8px 0;
        }
        
        .calculation-step h4 {
            color: #2c3e50;
            margin: 0 0 15px 0;
        }
        
        .formula {
            background: #e8f4fd;
            padding: 15px;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            margin: 10px 0;
            border: 1px solid #bee5eb;
            line-height: 1.6;
            word-wrap: break-word;
            font-size: 13px;
        }
        
        .step-result {
            background: #d4edda;
            color: #155724;
            padding: 15px;
            border-radius: 6px;
            margin: 10px 0;
            font-weight: bold;
            line-height: 1.5;
        }
        
        .rules-container {
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        
        .rule-section {
            background: #f1f3f4;
            padding: 25px;
            border-radius: 10px;
            border: 1px solid #ddd;
        }
        
        .rule-section h4 {
            color: #2c3e50;
            margin: 0 0 20px 0;
            font-size: 1.2em;
        }
        
        .fee-table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
            font-size: 13px;
        }
        
        .fee-table th, .fee-table td {
            padding: 10px 12px;
            text-align: left;
            border: 1px solid #ddd;
        }
        
        .fee-table th {
            background: #e9ecef;
            font-weight: 600;
        }
        
        .update-notice {
            background: #fff3cd;
            color: #856404;
            padding: 12px;
            border-radius: 8px;
            margin: 15px 0;
            border: 1px solid #ffeaa7;
            font-size: 14px;
        }
        
        /* éŸ¿æ‡‰å¼è¨­è¨ˆ */
        @media (max-width: 768px) {
            .container {
                margin: 10px;
                border-radius: 15px;
            }
            
            .header {
                padding: 20px;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .content {
                padding: 20px;
            }
            
            .input-group {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .rules-container {
                grid-template-columns: 1fr;
            }
            
            .comparison-table {
                font-size: 12px;
            }
            
            .comparison-table th,
            .comparison-table td {
                padding: 8px;
            }
            
            .tax-grid {
                grid-template-columns: 1fr;
            }
            
            /* é‡é»æ¯”è¼ƒå€å¡Šçš„éŸ¿æ‡‰å¼è¨­è¨ˆ */
            #calculationProcess .grid-2-cols,
            #taxCostsCalculation .grid-2-cols {
                grid-template-columns: 1fr !important;
                gap: 20px !important;
            }
            
            /* æŠ˜ç–Šå€å¡ŠéŸ¿æ‡‰å¼è¨­è¨ˆ */
            .calculation-section {
                margin: 10px 0;
            }
            
            .calculation-section-header h4 {
                font-size: 1.1em;
                padding-right: 20px;
            }
            
            .calculation-section-content {
                padding: 15px;
            }
        }
        
        @media (min-width: 769px) {
            .rules-container {
                grid-template-columns: 1fr 1fr;
            }
        }
        
        /* è¡¨æ ¼æ©«å‘æ»¾å‹• */
        .table-container {
            overflow-x: auto;
            margin: 15px 0;
        }
        
        .table-container table {
            min-width: 600px;
        }
        
        /* æŠ˜ç–ŠåŠŸèƒ½æ¨£å¼ */
        .collapsible-header {
            cursor: pointer;
            user-select: none;
            transition: all 0.3s ease;
            position: relative;
            padding-right: 30px;
        }
        
        .collapsible-header:hover {
            color: #3498db;
        }
        
        .collapse-icon {
            position: absolute;
            right: 0;
            transition: transform 0.3s ease;
            font-size: 0.8em;
        }
        
        .collapse-icon.collapsed {
            transform: rotate(-90deg);
        }
        
        .collapsible-content {
            overflow: hidden;
            transition: all 0.3s ease;
        }
        
        .collapsible-content.collapsed {
            max-height: 0;
            opacity: 0;
            margin: 0;
            padding: 0;
        }
        
        .calculation-section {
            border: 2px solid #e9ecef;
            border-radius: 15px;
            margin: 20px 0;
            overflow: hidden;
            background: #ffffff;
        }
        
        .calculation-section-header {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            padding: 15px 20px;
            cursor: pointer;
            user-select: none;
            transition: all 0.3s ease;
            position: relative;
            border-bottom: 1px solid #dee2e6;
        }
        
        .calculation-section-header:hover {
            background: linear-gradient(135deg, #e9ecef, #dee2e6);
        }
        
        .calculation-section-header h4 {
            margin: 0;
            color: #2c3e50;
            font-size: 1.2em;
            padding-right: 30px;
        }
        
        .calculation-section-content {
            padding: 20px;
            transition: all 0.3s ease;
            overflow: hidden;
        }
        
        .calculation-section-content.collapsed {
            max-height: 0;
            opacity: 0;
            padding: 0 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>0050 ETF vs é€£çµåŸºé‡‘æ¯”è¼ƒè¨ˆç®—å™¨</h1>
            <p>å®Œæ•´åˆ†ææŠ•è³‡æˆæœ¬ã€ç¨…å‹™å½±éŸ¿èˆ‡æœ€ä½³é¸æ“‡å»ºè­° - æ”¹é€²ç‰ˆ</p>
        </div>
        
        <div class="content">
            <div class="input-section">
                <h3>æŠ•è³‡åƒæ•¸è¨­å®š</h3>
                <div class="error-message" id="errorMessage"></div>
                <div class="input-group">
                    <div class="form-group">
                        <label for="monthlyInvestment">æ¯æœˆæŠ•è³‡é‡‘é¡ (å…ƒ)</label>
                        <input type="number" id="monthlyInvestment" value="3000" min="1000" max="100000" step="100">
                        <div class="input-hint">å»ºè­°ç¯„åœï¼š1,000 - 100,000 å…ƒ</div>
                    </div>
                    <div class="form-group">
                        <label for="investmentYears">æŠ•è³‡æœŸé–“ (å¹´)</label>
                        <input type="number" id="investmentYears" value="10" min="1" max="30" step="1">
                        <div class="input-hint">ç¯„åœï¼š1 - 30 å¹´</div>
                    </div>
                    <div class="form-group">
                        <label for="annualReturn">é æœŸå¹´åŒ–å ±é…¬ç‡ (%)</label>
                        <input type="number" id="annualReturn" value="8" min="0" max="20" step="0.1">
                        <div class="input-hint">ç¯„åœï¼š0 - 20%ï¼Œå»ºè­°5-12%</div>
                    </div>
                    <div class="form-group">
                        <label for="dividendYield">å¹´é…æ¯ç‡ (%)</label>
                        <input type="number" id="dividendYield" value="2.5" min="0" max="10" step="0.1">
                        <div class="input-hint">ç¯„åœï¼š0 - 10%</div>
                    </div>
                    <div class="form-group">
                        <label for="taxableRatio">54Cèª²ç¨…æ¯”ä¾‹ (%)</label>
                        <input type="number" id="taxableRatio" value="33" min="0" max="100" step="1">
                        <div class="input-hint">ç¯„åœï¼š0 - 100%</div>
                    </div>
                    <div class="form-group">
                        <label for="personalTaxRate">å€‹äººç¶œæ‰€ç¨…ç‡ (%)</label>
                        <select id="personalTaxRate">
                            <option value="5">5% (å¹´æ‰€å¾—56è¬ä»¥ä¸‹)</option>
                            <option value="12" selected>12% (å¹´æ‰€å¾—56-126è¬)</option>
                            <option value="20">20% (å¹´æ‰€å¾—126-252è¬)</option>
                            <option value="30">30% (å¹´æ‰€å¾—252-472è¬)</option>
                            <option value="40">40% (å¹´æ‰€å¾—472è¬ä»¥ä¸Š)</option>
                        </select>
                    </div>
                </div>
                <button class="calculate-btn" id="calculateBtn" onclick="handleCalculation()">
                    <span class="loading-spinner" id="loadingSpinner"></span>
                    <span id="btnText">é–‹å§‹è¨ˆç®—æ¯”è¼ƒ</span>
                </button>
                <div class="update-notice">
                    <strong>ğŸ“… æ•¸æ“šæ›´æ–°ï¼š</strong>åŸºé‡‘è¦æ¨¡æ•¸æ“šå®šæœŸæ›´æ–°ã€‚0050è¦æ¨¡ï¼š6,473.76å„„å…ƒï¼Œé€£çµåŸºé‡‘è¦æ¨¡ï¼š240å„„å…ƒï¼ˆ2024å¹´æ•¸æ“šï¼‰
                </div>
            </div>

            <div class="results" id="results">
                <div class="result-card">
                    <h3 class="collapsible-header" onclick="toggleCollapse('feeRules')">
                        ğŸ“‹ è²»ç”¨çµæ§‹è¦å‰‡èªªæ˜ <span class="collapse-icon">â–¼</span>
                    </h3>
                    <div id="feeRules" class="collapsible-content"></div>
                </div>

                <div class="result-card">
                    <h3>ğŸ§® å…§æ‰£è²»ç”¨</h3>
                    <div id="calculationProcess"></div>
                </div>

                <div class="result-card">
                    <h3>ğŸ’¸ äº¤æ˜“æˆæœ¬</h3>
                    <div id="transactionCostsCalculation"></div>
                </div>

                <div class="result-card">
                    <h3>ğŸ§¾ ç¨…å‹™æˆæœ¬</h3>
                    <div id="taxCostsCalculation"></div>
                </div>

                <div class="result-card">
                    <h3>ğŸ“Š ç¸½æˆæœ¬æ¯”è¼ƒ</h3>
                    <div id="totalComparison"></div>
                </div>

                <div class="result-card">
                    <h3>ğŸ’¡ æŠ•è³‡å»ºè­°</h3>
                    <div id="investmentAdvice"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // é…ç½®æ•¸æ“š - ä¾¿æ–¼ç¶­è­·å’Œæ›´æ–°
        const FUND_CONFIG = {
            etf0050: {
                scale: 6473.76, // 6,473.76å„„å…ƒ
                managementFeeRates: [
                    { threshold: 1000, rate: 0.15 },
                    { threshold: 5000, rate: 0.10 },
                    { threshold: 10000, rate: 0.08 },
                    { threshold: Infinity, rate: 0.05 }
                ],
                custodyFeeRates: [
                    { threshold: 10000, rate: 0.03 },
                    { threshold: Infinity, rate: 0.025 }
                ]
            },
            linkFund: {
                scale: 240, // 240å„„å…ƒ
                managementFeeRate: 0.0075, // 5% Ã— 0.15%
                custodyFeeRates: [
                    { threshold: 50, rate: 0.02 },
                    { threshold: 100, rate: 0.015 },
                    { threshold: Infinity, rate: 0.01 }
                ],
                bearRatio: 0.95 // 95%æ‰¿æ“”0050è²»ç”¨
            },
            validation: {
                monthlyInvestment: { min: 1000, max: 100000 },
                investmentYears: { min: 1, max: 30 },
                annualReturn: { min: 0, max: 20 },
                dividendYield: { min: 0, max: 10 },
                taxableRatio: { min: 0, max: 100 }
            }
        };

        // ä¸»è¨ˆç®—å™¨é¡åˆ¥
        class FundCalculator {
            constructor(config) {
                this.config = config;
            }

            // è¨ˆç®—éšæ¢¯å¼è²»ç‡
            calculateTieredFee(scale, feeRates) {
                let totalFee = 0;
                let remainingScale = scale;
                let prevThreshold = 0;

                for (const tier of feeRates) {
                    const tierAmount = Math.min(remainingScale, tier.threshold - prevThreshold);
                    if (tierAmount <= 0) break;
                    
                    totalFee += tierAmount * (tier.rate / 100);
                    remainingScale -= tierAmount;
                    prevThreshold = tier.threshold;
                    
                    if (remainingScale <= 0) break;
                }

                return (totalFee / scale) * 100; // è¿”å›ç™¾åˆ†æ¯”
            }

            // 0050 ETF ç¶“ç†è²»
            calculate0050ManagementFee() {
                return this.calculateTieredFee(
                    this.config.etf0050.scale,
                    this.config.etf0050.managementFeeRates
                );
            }

            // 0050 ETF ä¿ç®¡è²»
            calculate0050CustodyFee() {
                const scale = this.config.etf0050.scale;
                return scale < 10000 ? 0.03 : 0.025;
            }

            // é€£çµåŸºé‡‘ç¶“ç†è²»
            calculateLinkFundManagementFee() {
                return this.config.linkFund.managementFeeRate;
            }

            // é€£çµåŸºé‡‘ä¿ç®¡è²»
            calculateLinkFundCustodyFee() {
                return this.calculateTieredFee(
                    this.config.linkFund.scale,
                    this.config.linkFund.custodyFeeRates
                );
            }

            // é€£çµåŸºé‡‘æ‰¿æ“”0050è²»ç”¨
            calculateLinkFund0050Fee() {
                const etfTotalFee = this.calculate0050ManagementFee() + this.calculate0050CustodyFee();
                return this.config.linkFund.bearRatio * etfTotalFee;
            }

            // è¨ˆç®—ç´¯ç©è³‡ç”¢ï¼ˆä¿®æ­£ç²¾åº¦ï¼‰
            calculateAccumulatedAssets(monthlyAmount, years, annualReturn) {
                const monthlyReturn = annualReturn / 100 / 12;
                const totalMonths = years * 12;
                
                if (monthlyReturn === 0) {
                    return monthlyAmount * totalMonths;
                }
                
                // ä½¿ç”¨ç²¾ç¢ºçš„å¹´é‡‘ç¾å€¼å…¬å¼
                return monthlyAmount * (Math.pow(1 + monthlyReturn, totalMonths) - 1) / monthlyReturn;
            }

            // è¨ˆç®—äº¤æ˜“æˆæœ¬
            calculateTransactionCosts(finalAmount, monthlyAmount, years) {
                const totalMonths = years * 12;
                
                // ETFäº¤æ˜“æˆæœ¬
                const etfBuyFees = 1 * totalMonths; // æ¯æ¬¡ç”³è³¼1å…ƒ
                const etfSellFees = finalAmount * 0.001425 * 0.28; // æ‰‹çºŒè²»æŠ˜æ‰£
                const etfTax = finalAmount * 0.001; // è­‰äº¤ç¨…
                const etfTotal = etfBuyFees + etfSellFees + etfTax;
                
                // é€£çµåŸºé‡‘äº¤æ˜“æˆæœ¬ï¼ˆåŸºå¯Œé€šå¹³å°å…è²»ï¼‰
                const linkTotal = 0;
                
                return {
                    etf: {
                        buyFees: etfBuyFees,
                        sellFees: etfSellFees,
                        tax: etfTax,
                        total: etfTotal
                    },
                    link: {
                        total: linkTotal
                    }
                };
            }

            // è¨ˆç®—è‚¡åˆ©ç¨…å‹™ï¼ˆæ”¹é€²ç‰ˆï¼‰
            calculateDividendTax(monthlyAmount, years, annualReturn, dividendYield, taxableRatio, personalTaxRate) {
                const monthlyReturn = annualReturn / 100 / 12;
                let totalDividend = 0;
                
                // é€å¹´è¨ˆç®—é…æ¯
                for (let year = 1; year <= years; year++) {
                    const yearEndAssets = this.calculateAccumulatedAssets(monthlyAmount, year, annualReturn);
                    const yearDividend = yearEndAssets * dividendYield / 100;
                    totalDividend += yearDividend;
                }
                
                const totalTaxable = totalDividend * taxableRatio / 100;
                const taxOwed = totalTaxable * personalTaxRate / 100;
                const taxCredit = totalTaxable * 8.5 / 100; // å¯æŠµæ¸›ç¨…é¡
                const actualTax = Math.max(0, taxOwed - taxCredit);
                const refund = Math.max(0, taxCredit - taxOwed);
                
                return {
                    totalDividend,
                    totalTaxable,
                    taxOwed,
                    taxCredit,
                    actualTax,
                    refund
                };
            }
        }

        // è¼¸å…¥é©—è­‰å™¨
        class InputValidator {
            static validate(inputs) {
                const errors = [];
                const config = FUND_CONFIG.validation;
                
                // æª¢æŸ¥æ¯æœˆæŠ•è³‡é‡‘é¡
                if (inputs.monthlyInvestment < config.monthlyInvestment.min || 
                    inputs.monthlyInvestment > config.monthlyInvestment.max) {
                    errors.push(`æ¯æœˆæŠ•è³‡é‡‘é¡æ‡‰åœ¨ ${config.monthlyInvestment.min.toLocaleString()} - ${config.monthlyInvestment.max.toLocaleString()} å…ƒä¹‹é–“`);
                }
                
                // æª¢æŸ¥æŠ•è³‡æœŸé–“
                if (inputs.investmentYears < config.investmentYears.min || 
                    inputs.investmentYears > config.investmentYears.max) {
                    errors.push(`æŠ•è³‡æœŸé–“æ‡‰åœ¨ ${config.investmentYears.min} - ${config.investmentYears.max} å¹´ä¹‹é–“`);
                }
                
                // æª¢æŸ¥å¹´åŒ–å ±é…¬ç‡
                if (inputs.annualReturn < config.annualReturn.min || 
                    inputs.annualReturn > config.annualReturn.max) {
                    errors.push(`å¹´åŒ–å ±é…¬ç‡æ‡‰åœ¨ ${config.annualReturn.min}% - ${config.annualReturn.max}% ä¹‹é–“`);
                }
                
                // æª¢æŸ¥é…æ¯ç‡
                if (inputs.dividendYield < config.dividendYield.min || 
                    inputs.dividendYield > config.dividendYield.max) {
                    errors.push(`å¹´é…æ¯ç‡æ‡‰åœ¨ ${config.dividendYield.min}% - ${config.dividendYield.max}% ä¹‹é–“`);
                }
                
                // æª¢æŸ¥èª²ç¨…æ¯”ä¾‹
                if (inputs.taxableRatio < config.taxableRatio.min || 
                    inputs.taxableRatio > config.taxableRatio.max) {
                    errors.push(`54Cèª²ç¨…æ¯”ä¾‹æ‡‰åœ¨ ${config.taxableRatio.min}% - ${config.taxableRatio.max}% ä¹‹é–“`);
                }
                
                // é‚è¼¯æª¢æŸ¥
                if (inputs.dividendYield > inputs.annualReturn) {
                    errors.push('é…æ¯ç‡é€šå¸¸ä¸æ‡‰è¶…éç¸½å ±é…¬ç‡ï¼Œè«‹æª¢æŸ¥è¨­å®š');
                }
                
                return errors;
            }
            
            static highlightErrors(inputs, errors) {
                // æ¸…é™¤ä¹‹å‰çš„éŒ¯èª¤ç‹€æ…‹
                document.querySelectorAll('.form-group input').forEach(input => {
                    input.classList.remove('error');
                });
                
                // å¦‚æœæœ‰éŒ¯èª¤ï¼Œæ¨™è¨˜ç›¸é—œæ¬„ä½
                if (errors.length > 0) {
                    const config = FUND_CONFIG.validation;
                    
                    if (inputs.monthlyInvestment < config.monthlyInvestment.min || 
                        inputs.monthlyInvestment > config.monthlyInvestment.max) {
                        document.getElementById('monthlyInvestment').classList.add('error');
                    }
                    
                    if (inputs.investmentYears < config.investmentYears.min || 
                        inputs.investmentYears > config.investmentYears.max) {
                        document.getElementById('investmentYears').classList.add('error');
                    }
                    
                    if (inputs.annualReturn < config.annualReturn.min || 
                        inputs.annualReturn > config.annualReturn.max) {
                        document.getElementById('annualReturn').classList.add('error');
                    }
                    
                    if (inputs.dividendYield < config.dividendYield.min || 
                        inputs.dividendYield > config.dividendYield.max) {
                        document.getElementById('dividendYield').classList.add('error');
                    }
                    
                    if (inputs.taxableRatio < config.taxableRatio.min || 
                        inputs.taxableRatio > config.taxableRatio.max) {
                        document.getElementById('taxableRatio').classList.add('error');
                    }
                }
            }
        }

        // UI æ§åˆ¶å™¨
        class UIController {
            static showError(message) {
                const errorDiv = document.getElementById('errorMessage');
                errorDiv.textContent = message;
                errorDiv.style.display = 'block';
                errorDiv.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            }
            
            static hideError() {
                document.getElementById('errorMessage').style.display = 'none';
            }
            
            static showLoading() {
                const btn = document.getElementById('calculateBtn');
                const spinner = document.getElementById('loadingSpinner');
                const text = document.getElementById('btnText');
                
                btn.disabled = true;
                spinner.style.display = 'inline-block';
                text.textContent = 'è¨ˆç®—ä¸­...';
            }
            
            static hideLoading() {
                const btn = document.getElementById('calculateBtn');
                const spinner = document.getElementById('loadingSpinner');
                const text = document.getElementById('btnText');
                
                btn.disabled = false;
                spinner.style.display = 'none';
                text.textContent = 'é‡æ–°è¨ˆç®—';
            }
            
            static showResults() {
                const results = document.getElementById('results');
                results.classList.add('show');
                results.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        }

        // ç²å–ä½¿ç”¨è€…è¼¸å…¥
        function getInputValues() {
            return {
                monthlyInvestment: parseFloat(document.getElementById('monthlyInvestment').value) || 0,
                investmentYears: parseInt(document.getElementById('investmentYears').value) || 0,
                annualReturn: parseFloat(document.getElementById('annualReturn').value) || 0,
                dividendYield: parseFloat(document.getElementById('dividendYield').value) || 0,
                taxableRatio: parseFloat(document.getElementById('taxableRatio').value) || 0,
                personalTaxRate: parseFloat(document.getElementById('personalTaxRate').value) || 0
            };
        }

        // ä¸»è¨ˆç®—è™•ç†å‡½æ•¸
        async function handleCalculation() {
            try {
                UIController.hideError();
                UIController.showLoading();
                
                // ç²å–è¼¸å…¥å€¼
                const inputs = getInputValues();
                
                // é©—è­‰è¼¸å…¥
                const errors = InputValidator.validate(inputs);
                InputValidator.highlightErrors(inputs, errors);
                
                if (errors.length > 0) {
                    throw new Error(errors.join('ã€'));
                }
                
                // æ¨¡æ“¬è¨ˆç®—å»¶é²ï¼ˆè®“ä½¿ç”¨è€…çœ‹åˆ°è¼‰å…¥ç‹€æ…‹ï¼‰
                await new Promise(resolve => setTimeout(resolve, 500));
                
                // åŸ·è¡Œè¨ˆç®—
                await calculateComparison(inputs);
                
            } catch (error) {
                UIController.showError(error.message);
            } finally {
                UIController.hideLoading();
            }
        }

        // ä¸»è¦è¨ˆç®—å‡½æ•¸ï¼ˆæ”¹é€²ç‰ˆï¼‰
        async function calculateComparison(inputs) {
            const calculator = new FundCalculator(FUND_CONFIG);
            
            // è¨ˆç®—å„ç¨®è²»ç‡
            const etf0050ManagementFee = calculator.calculate0050ManagementFee();
            const etf0050CustodyFee = calculator.calculate0050CustodyFee();
            const etf0050TotalFee = etf0050ManagementFee + etf0050CustodyFee;
            
            const linkManagementFee = calculator.calculateLinkFundManagementFee();
            const linkCustodyFee = calculator.calculateLinkFundCustodyFee();
            const link0050Fee = calculator.calculateLinkFund0050Fee();
            const linkTotalFee = linkManagementFee + linkCustodyFee + link0050Fee;
            
            // è¨ˆç®—ç´¯ç©è³‡ç”¢
            const finalAmount = calculator.calculateAccumulatedAssets(
                inputs.monthlyInvestment, 
                inputs.investmentYears, 
                inputs.annualReturn
            );
            
            // ä¼°ç®—å¹³å‡è³‡ç”¢ï¼ˆç”¨æ–¼è¨ˆç®—å…§æ‰£è²»ç”¨ï¼‰
            const averageAssets = finalAmount * 0.6; // ç°¡åŒ–ä¼°ç®—
            
            // è¨ˆç®—å…§æ‰£è²»ç”¨
            const etfInternalFees = averageAssets * etf0050TotalFee / 100;
            const linkInternalFees = averageAssets * linkTotalFee / 100;
            
            // è¨ˆç®—äº¤æ˜“æˆæœ¬
            const transactionCosts = calculator.calculateTransactionCosts(
                finalAmount, 
                inputs.monthlyInvestment, 
                inputs.investmentYears
            );
            
            // è¨ˆç®—ç¨…å‹™
            const taxAnalysis = calculator.calculateDividendTax(
                inputs.monthlyInvestment,
                inputs.investmentYears,
                inputs.annualReturn,
                inputs.dividendYield,
                inputs.taxableRatio,
                inputs.personalTaxRate
            );
            
            // è¨ˆç®—ç¸½æˆæœ¬
            const netTaxCost = taxAnalysis.actualTax - taxAnalysis.refund;
            const etfTotalCost = etfInternalFees + transactionCosts.etf.total + netTaxCost;
            const linkTotalCost = linkInternalFees + transactionCosts.link.total;
            
            // æº–å‚™çµæœæ•¸æ“š
            const results = {
                fees: {
                    etf: { 
                        management: etf0050ManagementFee, 
                        custody: etf0050CustodyFee, 
                        total: etf0050TotalFee 
                    },
                    link: { 
                        management: linkManagementFee, 
                        custody: linkCustodyFee, 
                        æ‰¿æ“”0050è²»ç”¨: link0050Fee, 
                        total: linkTotalFee 
                    }
                },
                internalFees: { etf: etfInternalFees, link: linkInternalFees },
                transactionCosts: transactionCosts,
                taxAnalysis: taxAnalysis,
                totalCosts: { etf: etfTotalCost, link: linkTotalCost },
                finalAmount: finalAmount,
                inputs: inputs
            };
            
            // é¡¯ç¤ºçµæœ
            displayResults(results);
            UIController.showResults();
        }

        // é¡¯ç¤ºè²»ç”¨è¦å‰‡ï¼ˆç°¡åŒ–ç‰ˆï¼‰
        function displayFeeRules() {
            const rulesDiv = document.getElementById('feeRules');
            rulesDiv.innerHTML = `
                <div class="rules-container">
                    <div class="rule-section">
                        <h4>ğŸ¦ 0050 ETF è²»ç”¨çµæ§‹</h4>
                        <p><strong>åŸºé‡‘è¦æ¨¡ï¼š${FUND_CONFIG.etf0050.scale.toLocaleString()}å„„å…ƒ</strong></p>
                        <h5>ç¶“ç†è²»éšæ¢¯å¼æ”¶è²»ï¼š</h5>
                        <table class="fee-table">
                            <thead><tr><th>è³‡ç”¢è¦æ¨¡</th><th>è²»ç‡</th></tr></thead>
                            <tbody>
                                <tr><td>å‰1,000å„„</td><td>0.15%</td></tr>
                                <tr><td>1,000-5,000å„„</td><td>0.10%</td></tr>
                                <tr><td>5,000å„„-1å…†</td><td>0.08%</td></tr>
                                <tr><td>è¶…é1å…†</td><td>0.05%</td></tr>
                            </tbody>
                        </table>
                        <h5>ä¿ç®¡è²»ï¼š</h5>
                        <p>1å…†å…ƒä»¥ä¸‹ï¼š0.03%ï¼Œè¶…é1å…†å…ƒï¼š0.025%</p>
                    </div>
                    <div class="rule-section">
                        <h4>ğŸ”— é€£çµåŸºé‡‘Aé¡ è²»ç”¨çµæ§‹</h4>
                        <p><strong>åŸºé‡‘è¦æ¨¡ï¼š${FUND_CONFIG.linkFund.scale}å„„å…ƒ</strong></p>
                        <h5>ç¶“ç†è²»ï¼š</h5>
                        <p>åƒ…å°5%ç¾é‡‘éƒ¨ä½æ”¶å–0.15%ç¶“ç†è²»</p>
                        <h5>ä¿ç®¡è²»éšæ¢¯å¼æ”¶è²»ï¼š</h5>
                        <table class="fee-table">
                            <thead><tr><th>è³‡ç”¢è¦æ¨¡</th><th>è²»ç‡</th></tr></thead>
                            <tbody>
                                <tr><td>å‰50å„„</td><td>0.02%</td></tr>
                                <tr><td>50-100å„„</td><td>0.015%</td></tr>
                                <tr><td>è¶…é100å„„</td><td>0.01%</td></tr>
                            </tbody>
                        </table>
                        <h5>æ‰¿æ“”è²»ç”¨ï¼š</h5>
                        <p>95%æŠ•è³‡éƒ¨ä½æ‰¿æ“”0050çš„ç¶“ç†è²»å’Œä¿ç®¡è²»</p>
                    </div>
                </div>
            `;
        }

        // æŠ˜ç–ŠåŠŸèƒ½
        function toggleCollapse(elementId) {
            const content = document.getElementById(elementId);
            const header = content.previousElementSibling;
            const icon = header.querySelector('.collapse-icon');
            
            content.classList.toggle('collapsed');
            icon.classList.toggle('collapsed');
        }
        
        function toggleCalculationSection(sectionId) {
            const content = document.getElementById(sectionId);
            const header = content.previousElementSibling;
            const icon = header.querySelector('.collapse-icon');
            
            content.classList.toggle('collapsed');
            icon.classList.toggle('collapsed');
        }

        // é¡¯ç¤ºå…§æ‰£è²»ç”¨è¨ˆç®—ï¼ˆæ•´åˆè¡¨æ ¼å’Œé‡é»æ¯”è¼ƒï¼Œæ·»åŠ æŠ˜ç–ŠåŠŸèƒ½ï¼‰
        function displayCalculationProcess(results) {
            const processDiv = document.getElementById('calculationProcess');
            const inputs = results.inputs;
            const calculator = new FundCalculator(FUND_CONFIG);
            
            // ç²å–è©³ç´°è¨ˆç®—æ•¸æ“š
            const scale0050 = FUND_CONFIG.etf0050.scale;
            const scaleLinkFund = FUND_CONFIG.linkFund.scale;
            
            // è¨ˆç®—0050ç¶“ç†è²»çš„å„éšæ®µ
            const mgmtFee1 = Math.min(1000, scale0050) * 0.15 / 100;
            const mgmtFee2 = Math.min(Math.max(0, scale0050 - 1000), 4000) * 0.10 / 100;
            const mgmtFee3 = Math.min(Math.max(0, scale0050 - 5000), 5000) * 0.08 / 100;
            const mgmtFee4 = Math.max(0, scale0050 - 10000) * 0.05 / 100;
            const totalMgmtFee = mgmtFee1 + mgmtFee2 + mgmtFee3 + mgmtFee4;
            
            // è¨ˆç®—é€£çµåŸºé‡‘ä¿ç®¡è²»çš„å„éšæ®µ
            const custodyFee1 = Math.min(50, scaleLinkFund) * 0.02 / 100;
            const custodyFee2 = Math.min(Math.max(0, scaleLinkFund - 50), 50) * 0.015 / 100;
            const custodyFee3 = Math.max(0, scaleLinkFund - 100) * 0.01 / 100;
            const totalLinkCustodyFee = custodyFee1 + custodyFee2 + custodyFee3;
            
            // è²»ç”¨å·®ç•°è¨ˆç®—
            const feeDifference = results.internalFees.etf - results.internalFees.link;
            
            processDiv.innerHTML = `
                <div class="calculation-section">
                    <div class="calculation-section-header" onclick="toggleCalculationSection('etfCalculationContent')">
                        <h4>ğŸ¦ 0050 ETF å…§æ‰£è²»ç”¨è¨ˆç®— <span class="collapse-icon">â–¼</span></h4>
                    </div>
                    <div id="etfCalculationContent" class="calculation-section-content">
                        <div class="calculation-step">
                            <h4>ğŸ’° ç¶“ç†è²»éšæ¢¯è¨ˆç®—</h4>
                            <div class="formula">
                                åŸºé‡‘è¦æ¨¡ï¼š${scale0050.toLocaleString()}å„„å…ƒ<br><br>
                                éšæ¢¯è¨ˆç®—éç¨‹ï¼š<br>
                                â€¢ å‰1,000å„„å…ƒ Ã— 0.15% = ${Math.min(1000, scale0050).toLocaleString()}å„„ Ã— 0.15% = ${mgmtFee1.toFixed(4)}å„„å…ƒ<br>
                                ${scale0050 > 1000 ? `â€¢ 1,000-5,000å„„å…ƒ Ã— 0.10% = ${Math.min(Math.max(0, scale0050 - 1000), 4000).toLocaleString()}å„„ Ã— 0.10% = ${mgmtFee2.toFixed(4)}å„„å…ƒ<br>` : ''}
                                ${scale0050 > 5000 ? `â€¢ 5,000-10,000å„„å…ƒ Ã— 0.08% = ${Math.min(Math.max(0, scale0050 - 5000), 5000).toLocaleString()}å„„ Ã— 0.08% = ${mgmtFee3.toFixed(4)}å„„å…ƒ<br>` : ''}
                                ${scale0050 > 10000 ? `â€¢ è¶…é10,000å„„å…ƒ Ã— 0.05% = ${Math.max(0, scale0050 - 10000).toLocaleString()}å„„ Ã— 0.05% = ${mgmtFee4.toFixed(4)}å„„å…ƒ<br>` : ''}
                                <br>
                                ç¸½ç¶“ç†è²» = ${mgmtFee1.toFixed(4)} + ${mgmtFee2.toFixed(4)} + ${mgmtFee3.toFixed(4)} + ${mgmtFee4.toFixed(4)} = ${totalMgmtFee.toFixed(4)}å„„å…ƒ
                            </div>
                            <div class="step-result">
                                ç¶“ç†è²»ç‡ = ${totalMgmtFee.toFixed(4)}å„„ Ã· ${scale0050.toLocaleString()}å„„ Ã— 100% = ${results.fees.etf.management.toFixed(6)}%
                            </div>
                        </div>
                        
                        <div class="calculation-step">
                            <h4>ğŸ›ï¸ ä¿ç®¡è²»è¨ˆç®—</h4>
                            <div class="formula">
                                åŸºé‡‘è¦æ¨¡ï¼š${scale0050.toLocaleString()}å„„å…ƒ<br>
                                é©ç”¨è¦å‰‡ï¼š${scale0050 < 10000 ? 'æœªé”1å…†å…ƒï¼Œé©ç”¨0.03%' : 'å·²é”1å…†å…ƒï¼Œé©ç”¨0.025%'}
                            </div>
                            <div class="step-result">
                                ä¿ç®¡è²»ç‡ = ${results.fees.etf.custody.toFixed(3)}%
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="calculation-section">
                    <div class="calculation-section-header" onclick="toggleCalculationSection('linkFundCalculationContent')">
                        <h4>ğŸ”— é€£çµåŸºé‡‘Aé¡ å…§æ‰£è²»ç”¨è¨ˆç®— <span class="collapse-icon">â–¼</span></h4>
                    </div>
                    <div id="linkFundCalculationContent" class="calculation-section-content">
                        <div class="calculation-step">
                            <h4>ğŸ’° ç¶“ç†è²»è¨ˆç®—</h4>
                            <div class="formula">
                                æŠ•è³‡ç­–ç•¥ï¼š<br>
                                â€¢ 95%æŠ•è³‡0050ï¼šä¸æ”¶å–ç¶“ç†è²»<br>
                                â€¢ 5%ç¾é‡‘éƒ¨ä½ï¼šæŒ‰0050ç¶“ç†è²»è¦å‰‡æ”¶å–<br><br>
                                
                                è¨ˆç®—éç¨‹ï¼š<br>
                                ç¾é‡‘éƒ¨ä½ç¶“ç†è²» = 5% Ã— 0.15% = 0.0075%<br>
                                ï¼ˆ0.15%ç‚º0050åœ¨å‰1,000å„„é©ç”¨çš„è²»ç‡ï¼‰
                            </div>
                            <div class="step-result">
                                ç¶“ç†è²»ç‡ = ${results.fees.link.management.toFixed(4)}%
                            </div>
                        </div>
                        
                        <div class="calculation-step">
                            <h4>ğŸ›ï¸ ä¿ç®¡è²»éšæ¢¯è¨ˆç®—</h4>
                            <div class="formula">
                                åŸºé‡‘è¦æ¨¡ï¼š${scaleLinkFund}å„„å…ƒ<br><br>
                                éšæ¢¯è¨ˆç®—éç¨‹ï¼š<br>
                                â€¢ å‰50å„„å…ƒ Ã— 0.02% = ${Math.min(50, scaleLinkFund)}å„„ Ã— 0.02% = ${custodyFee1.toFixed(6)}å„„å…ƒ<br>
                                ${scaleLinkFund > 50 ? `â€¢ 50-100å„„å…ƒ Ã— 0.015% = ${Math.min(Math.max(0, scaleLinkFund - 50), 50)}å„„ Ã— 0.015% = ${custodyFee2.toFixed(6)}å„„å…ƒ<br>` : ''}
                                ${scaleLinkFund > 100 ? `â€¢ è¶…é100å„„å…ƒ Ã— 0.01% = ${Math.max(0, scaleLinkFund - 100)}å„„ Ã— 0.01% = ${custodyFee3.toFixed(6)}å„„å…ƒ<br>` : ''}
                                <br>
                                ç¸½ä¿ç®¡è²» = ${custodyFee1.toFixed(6)} + ${custodyFee2.toFixed(6)} + ${custodyFee3.toFixed(6)} = ${totalLinkCustodyFee.toFixed(6)}å„„å…ƒ
                            </div>
                            <div class="step-result">
                                ä¿ç®¡è²»ç‡ = ${totalLinkCustodyFee.toFixed(6)}å„„ Ã· ${scaleLinkFund}å„„ Ã— 100% = ${results.fees.link.custody.toFixed(6)}%
                            </div>
                        </div>
                        
                        <div class="calculation-step">
                            <h4>ğŸ’¼ æ‰¿æ“”0050è²»ç”¨è¨ˆç®—</h4>
                            <div class="formula">
                                0050ç¸½è²»ç”¨ç‡ = ${results.fees.etf.management.toFixed(6)}% + ${results.fees.etf.custody.toFixed(3)}% = ${results.fees.etf.total.toFixed(6)}%<br><br>
                                
                                é€£çµåŸºé‡‘æ‰¿æ“”è²»ç”¨ï¼š<br>
                                æ‰¿æ“”æ¯”ä¾‹ Ã— 0050ç¸½è²»ç”¨ç‡<br>
                                = 95% Ã— ${results.fees.etf.total.toFixed(6)}% = ${results.fees.link.æ‰¿æ“”0050è²»ç”¨.toFixed(6)}%
                            </div>
                            <div class="step-result">
                                æ‰¿æ“”0050è²»ç”¨ï¼š${results.fees.link.æ‰¿æ“”0050è²»ç”¨.toFixed(6)}%
                            </div>
                        </div>
                    </div>
                </div>
                
                <div style="margin: 30px 0;">
                    <h4 class="collapsible-header" onclick="toggleCollapse('feeStructureContent')" style="color: #2c3e50; margin: 0 0 20px 0; font-size: 1.4em; border-bottom: 3px solid #3498db; padding-bottom: 10px; cursor: pointer; user-select: none; position: relative; padding-right: 30px;">
                        ğŸ’° è²»ç”¨çµæ§‹åˆ†æ <span class="collapse-icon">â–¼</span>
                    </h4>
                    <div id="feeStructureContent" class="collapsible-content">
                        <div class="table-container">
                            <table class="comparison-table">
                                <thead>
                                    <tr>
                                        <th>è²»ç”¨é …ç›®</th>
                                        <th>0050 ETF</th>
                                        <th>é€£çµåŸºé‡‘Aé¡</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>ç¶“ç†è²»</td>
                                        <td>${results.fees.etf.management.toFixed(4)}%</td>
                                        <td>${results.fees.link.management.toFixed(4)}%</td>
                                    </tr>
                                    <tr>
                                        <td>ä¿ç®¡è²»</td>
                                        <td>${results.fees.etf.custody.toFixed(3)}%</td>
                                        <td>${results.fees.link.custody.toFixed(4)}%</td>
                                    </tr>
                                    <tr>
                                        <td>æ‰¿æ“”0050è²»ç”¨</td>
                                        <td>-</td>
                                        <td>${results.fees.link.æ‰¿æ“”0050è²»ç”¨.toFixed(4)}%</td>
                                    </tr>
                                    <tr style="font-weight: bold; background: #f8f9fa;">
                                        <td>ç¸½è²»ç”¨ç‡</td>
                                        <td>${results.fees.etf.total.toFixed(4)}%</td>
                                        <td class="${results.fees.link.total < results.fees.etf.total ? 'winner' : ''}">${results.fees.link.total.toFixed(4)}%</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                
                <div style="margin: 30px 0;">
                    <h4 style="color: #2c3e50; margin: 0 0 20px 0; font-size: 1.4em; border-bottom: 3px solid #3498db; padding-bottom: 10px;">ğŸ¯ ç¸½å…§æ‰£è²»ç”¨æ¯”è¼ƒ</h4>
                    <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 30px; border-radius: 15px; margin: 20px 0;">
                        <div class="grid-2-cols" style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px; align-items: center;">
                            <div style="text-align: center;">
                                <h4 style="color: white; margin: 0 0 15px 0; font-size: 1.3em;">ğŸ¦ 0050 ETF</h4>
                                <div style="background: rgba(255,255,255,0.2); padding: 20px; border-radius: 10px;">
                                    <div style="font-size: 0.9em; opacity: 0.9; margin-bottom: 8px;">å¹´è²»ç”¨ç‡</div>
                                    <div style="font-size: 2.2em; font-weight: bold; color: #4caf50;">${results.fees.etf.total.toFixed(4)}%</div>
                                </div>
                            </div>
                            <div style="text-align: center;">
                                <h4 style="color: white; margin: 0 0 15px 0; font-size: 1.3em;">ğŸ”— é€£çµåŸºé‡‘Aé¡</h4>
                                <div style="background: rgba(255,255,255,0.2); padding: 20px; border-radius: 10px;">
                                    <div style="font-size: 0.9em; opacity: 0.9; margin-bottom: 8px;">å¹´è²»ç”¨ç‡</div>
                                    <div style="font-size: 2.2em; font-weight: bold; color: #e74c3c;">${results.fees.link.total.toFixed(4)}%</div>
                                </div>
                            </div>
                        </div>
                        
                        <div style="text-align: center; margin-top: 25px; padding-top: 25px; border-top: 2px solid rgba(255,255,255,0.3);">
                            <div style="font-size: 1.1em; margin-bottom: 10px;">ğŸ’° å¹´è²»ç”¨ç‡å·®ç•°</div>
                            <div style="font-size: 2.5em; font-weight: bold; color: #e74c3c;">
                                ${(results.fees.etf.total - results.fees.link.total).toFixed(4)}%
                            </div>
                            <div style="font-size: 1em; opacity: 0.9; margin-top: 8px;">
                                ${results.fees.etf.total > results.fees.link.total ? 
                                    'é€£çµåŸºé‡‘Aé¡è²»ç”¨ç‡è¼ƒä½' :
                                    '0050 ETFè²»ç”¨ç‡è¼ƒä½'
                                }
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // é¡¯ç¤ºäº¤æ˜“æˆæœ¬è©³ç´°è¨ˆç®—ï¼ˆæ•´åˆè¡¨æ ¼ä¸¦æ·»åŠ æŠ˜ç–ŠåŠŸèƒ½ï¼‰
        function displayTransactionCostsCalculation(results) {
            const calculationDiv = document.getElementById('transactionCostsCalculation');
            const inputs = results.inputs;
            const totalMonths = inputs.investmentYears * 12;
            
            calculationDiv.innerHTML = `
                <div class="calculation-section">
                    <div class="calculation-section-header" onclick="toggleCalculationSection('investmentRulesContent')">
                        <h4>ğŸ“‹ å®šæœŸå®šé¡æŠ•è³‡è¦å‰‡èªªæ˜ <span class="collapse-icon">â–¼</span></h4>
                    </div>
                    <div id="investmentRulesContent" class="calculation-section-content">
                        <div class="calculation-step">
                            <h4>ğŸ”„ å®šæœŸå®šé¡æŠ•è³‡å‡è¨­</h4>
                            <div class="formula">
                                æŠ•è³‡æ–¹å¼è¨­å®šï¼š<br>
                                â€¢ æ¯æœˆå›ºå®šæŠ•è³‡ï¼š${inputs.monthlyInvestment.toLocaleString()}å…ƒ<br>
                                â€¢ æŠ•è³‡æœŸé–“ï¼š${inputs.investmentYears}å¹´ï¼ˆå…±${totalMonths}å€‹æœˆï¼‰<br>
                                â€¢ æŠ•è³‡é »ç‡ï¼šæ¯æœˆ1æ¬¡ï¼Œå›ºå®šæ—¥æœŸæ‰£æ¬¾<br>
                                â€¢ æœŸæœ«ä¸€æ¬¡æ€§è´–å›ï¼šç¬¬${inputs.investmentYears}å¹´åº•å…¨é¡è´–å›<br><br>
                                
                                0050 ETF äº¤æ˜“è¦å‰‡ï¼š<br>
                                â€¢ ç”³è³¼å¹³å°ï¼šåˆ¸å•†å¹³å°ï¼ˆå¦‚å¯Œé‚¦ã€åœ‹æ³°ç­‰ï¼‰<br>
                                â€¢ ç”³è³¼æ‰‹çºŒè²»ï¼šæ¯æ¬¡1å…ƒï¼ˆå®šæœŸå®šé¡å„ªæƒ ï¼‰<br>
                                â€¢ è´–å›æ‰‹çºŒè²»ï¼š0.1425% Ã— 28æŠ˜ï¼ˆç¶²è·¯ä¸‹å–®å„ªæƒ ï¼‰<br>
                                â€¢ è­‰äº¤ç¨…ï¼šè³£å‡ºé‡‘é¡ Ã— 0.1%<br><br>
                                
                                é€£çµåŸºé‡‘Aé¡ äº¤æ˜“è¦å‰‡ï¼š<br>
                                â€¢ ç”³è³¼å¹³å°ï¼šåŸºå¯Œé€šå¹³å°<br>
                                â€¢ ç”³è³¼æ‰‹çºŒè²»ï¼šå®Œå…¨å…è²»<br>
                                â€¢ è´–å›æ‰‹çºŒè²»ï¼šå®Œå…¨å…è²»<br>
                                â€¢ è­‰äº¤ç¨…ï¼šåŸºé‡‘é¡å‹å…ç¨…
                            </div>
                            <div class="step-result">
                                ä»¥ä¸Šè¦å‰‡ç‚ºå¯¦éš›æŠ•è³‡æ™‚çš„ä¸€èˆ¬æƒ…æ³ï¼Œå¯¦éš›è²»ç”¨è«‹ä»¥å„å¹³å°å…¬å‘Šç‚ºæº–
                            </div>
                        </div>
                        
                        <div class="calculation-step">
                            <h4>ğŸ“ˆ ç´¯ç©è³‡ç”¢è¨ˆç®—é‚è¼¯</h4>
                            <div class="formula">
                                å®šæœŸå®šé¡è¤‡åˆ©è¨ˆç®—å…¬å¼ï¼š<br>
                                FV = PMT Ã— [(1 + r)^n - 1] / r<br><br>
                                
                                åƒæ•¸è¨­å®šï¼š<br>
                                â€¢ PMTï¼ˆæ¯æœˆæŠ•è³‡ï¼‰= ${inputs.monthlyInvestment.toLocaleString()}å…ƒ<br>
                                â€¢ rï¼ˆæœˆå ±é…¬ç‡ï¼‰= ${inputs.annualReturn}% Ã· 12 = ${(inputs.annualReturn/12).toFixed(4)}%<br>
                                â€¢ nï¼ˆç¸½æŠ•è³‡æœˆæ•¸ï¼‰= ${inputs.investmentYears}å¹´ Ã— 12 = ${totalMonths}å€‹æœˆ<br><br>
                                
                                è¨ˆç®—éç¨‹ï¼š<br>
                                ${inputs.annualReturn === 0 ? 
                                    `ç„¡åˆ©æ¯æƒ…æ³ï¼š${inputs.monthlyInvestment.toLocaleString()} Ã— ${totalMonths} = ${Math.round(inputs.monthlyInvestment * totalMonths).toLocaleString()}å…ƒ` :
                                    `FV = ${inputs.monthlyInvestment.toLocaleString()} Ã— [(1 + ${(inputs.annualReturn/12/100).toFixed(6)})^${totalMonths} - 1] / ${(inputs.annualReturn/12/100).toFixed(6)}<br>
                                    FV = ${inputs.monthlyInvestment.toLocaleString()} Ã— ${((Math.pow(1 + inputs.annualReturn/100/12, totalMonths) - 1) / (inputs.annualReturn/100/12)).toFixed(4)}`
                                }
                            </div>
                            <div class="step-result">
                                ${inputs.investmentYears}å¹´å¾Œç´¯ç©è³‡ç”¢ï¼ˆè´–å›é‡‘é¡ï¼‰ï¼š${Math.round(results.finalAmount).toLocaleString()}å…ƒ<br>
                                æ­¤é‡‘é¡å°‡ä½œç‚ºå¾ŒçºŒäº¤æ˜“æˆæœ¬è¨ˆç®—çš„åŸºç¤
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="calculation-section">
                    <div class="calculation-section-header" onclick="toggleCalculationSection('etfTransactionContent')">
                        <h4>ğŸ¦ 0050 ETF äº¤æ˜“æˆæœ¬è©³ç´°è¨ˆç®— <span class="collapse-icon">â–¼</span></h4>
                    </div>
                    <div id="etfTransactionContent" class="calculation-section-content">
                        <div class="calculation-step">
                            <h4>ğŸ’¸ ç”³è³¼æ‰‹çºŒè²»è¨ˆç®—</h4>
                            <div class="formula">
                                è¨ˆç®—éç¨‹ï¼š<br>
                                ç¸½ç”³è³¼æ‰‹çºŒè²» = 1å…ƒ/æ¬¡ Ã— ${totalMonths}æ¬¡ = ${Math.round(results.transactionCosts.etf.buyFees)}å…ƒ
                            </div>
                            <div class="step-result">
                                ç”³è³¼æ‰‹çºŒè²»ï¼š${Math.round(results.transactionCosts.etf.buyFees)}å…ƒ
                            </div>
                        </div>
                        
                        <div class="calculation-step">
                            <h4>ğŸ’¸ è´–å›æ‰‹çºŒè²»è¨ˆç®—</h4>
                            <div class="formula">
                                è´–å›é‡‘é¡ï¼š${Math.round(results.finalAmount).toLocaleString()}å…ƒ<br>
                                åˆ¸å•†æ‰‹çºŒè²»ç‡ï¼š0.1425%<br>
                                å„ªæƒ æŠ˜æ‰£ï¼š28æŠ˜ï¼ˆå¤šæ•¸åˆ¸å•†ç¶²è·¯ä¸‹å–®å„ªæƒ ï¼‰<br><br>
                                
                                è¨ˆç®—éç¨‹ï¼š<br>
                                è´–å›æ‰‹çºŒè²» = ${Math.round(results.finalAmount).toLocaleString()}å…ƒ Ã— 0.1425% Ã— 28% = ${Math.round(results.transactionCosts.etf.sellFees)}å…ƒ
                            </div>
                            <div class="step-result">
                                è´–å›æ‰‹çºŒè²»ï¼š${Math.round(results.transactionCosts.etf.sellFees)}å…ƒ
                            </div>
                        </div>
                        
                        <div class="calculation-step">
                            <h4>ğŸ’¸ è­‰äº¤ç¨…è¨ˆç®—</h4>
                            <div class="formula">
                                è´–å›é‡‘é¡ï¼š${Math.round(results.finalAmount).toLocaleString()}å…ƒ<br>
                                è­‰äº¤ç¨…ç‡ï¼š0.1%ï¼ˆETFè³£å‡ºæ™‚èª²å¾µï¼‰<br><br>
                                
                                è¨ˆç®—éç¨‹ï¼š<br>
                                è­‰äº¤ç¨… = ${Math.round(results.finalAmount).toLocaleString()}å…ƒ Ã— 0.1% = ${Math.round(results.transactionCosts.etf.tax)}å…ƒ
                            </div>
                            <div class="step-result">
                                è­‰äº¤ç¨…ï¼š${Math.round(results.transactionCosts.etf.tax)}å…ƒ
                            </div>
                        </div>
                        
                        <div class="calculation-step">
                            <h4>ğŸ“Š 0050 ETF äº¤æ˜“æˆæœ¬ç¸½è¨ˆ</h4>
                            <div class="formula">
                                ç¸½äº¤æ˜“æˆæœ¬ = ç”³è³¼æ‰‹çºŒè²» + è´–å›æ‰‹çºŒè²» + è­‰äº¤ç¨…<br>
                                = ${Math.round(results.transactionCosts.etf.buyFees)}å…ƒ + ${Math.round(results.transactionCosts.etf.sellFees)}å…ƒ + ${Math.round(results.transactionCosts.etf.tax)}å…ƒ
                            </div>
                            <div class="step-result">
                                0050 ETF ç¸½äº¤æ˜“æˆæœ¬ï¼š${Math.round(results.transactionCosts.etf.total)}å…ƒ
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="calculation-section">
                    <div class="calculation-section-header" onclick="toggleCalculationSection('linkFundTransactionContent')">
                        <h4>ğŸ”— é€£çµåŸºé‡‘Aé¡ äº¤æ˜“æˆæœ¬è©³ç´°è¨ˆç®— <span class="collapse-icon">â–¼</span></h4>
                    </div>
                    <div id="linkFundTransactionContent" class="calculation-section-content">
                        <div class="calculation-step">
                            <h4>ğŸ’¸ ç”³è³¼æ‰‹çºŒè²»è¨ˆç®—</h4>
                            <div class="formula">
                                åŸºå¯Œé€šå¹³å°å„ªæƒ ï¼š<br>
                                â€¢ å®šæœŸå®šé¡ç”³è³¼ï¼šå…æ‰‹çºŒè²»<br>
                                â€¢ å–®ç­†ç”³è³¼ï¼šå…æ‰‹çºŒè²»<br>
                                â€¢ å¹³å°è£œè²¼ï¼šå®Œå…¨å…è²»
                            </div>
                            <div class="step-result">
                                ç”³è³¼æ‰‹çºŒè²»ï¼š0å…ƒ
                            </div>
                        </div>
                        
                        <div class="calculation-step">
                            <h4>ğŸ’¸ è´–å›æ‰‹çºŒè²»è¨ˆç®—</h4>
                            <div class="formula">
                                åŸºå¯Œé€šå¹³å°å„ªæƒ ï¼š<br>
                                â€¢ åŸºé‡‘è´–å›ï¼šå…æ‰‹çºŒè²»<br>
                                â€¢ ç„¡æœ€ä½é‡‘é¡é™åˆ¶<br>
                                â€¢ å¹³å°è£œè²¼ï¼šå®Œå…¨å…è²»
                            </div>
                            <div class="step-result">
                                è´–å›æ‰‹çºŒè²»ï¼š0å…ƒ
                            </div>
                        </div>
                        
                        <div class="calculation-step">
                            <h4>ğŸ’¸ è­‰äº¤ç¨…è¨ˆç®—</h4>
                            <div class="formula">
                                åŸºé‡‘é¡å‹ç‰¹æ€§ï¼š<br>
                                â€¢ åŸºé‡‘å—ç›Šæ†‘è­‰ï¼šå…è­‰äº¤ç¨…<br>
                                â€¢ éè‚¡ç¥¨é¡å•†å“ï¼šä¸é©ç”¨è­‰äº¤ç¨…<br>
                                â€¢ æ³•è¦è±å…ï¼šå®Œå…¨å…ç¨…
                            </div>
                            <div class="step-result">
                                è­‰äº¤ç¨…ï¼š0å…ƒ
                            </div>
                        </div>
                        
                        <div class="calculation-step">
                            <h4>ğŸ“Š é€£çµåŸºé‡‘Aé¡ äº¤æ˜“æˆæœ¬ç¸½è¨ˆ</h4>
                            <div class="formula">
                                ç¸½äº¤æ˜“æˆæœ¬ = ç”³è³¼æ‰‹çºŒè²» + è´–å›æ‰‹çºŒè²» + è­‰äº¤ç¨…<br>
                                = 0å…ƒ + 0å…ƒ + 0å…ƒ
                            </div>
                            <div class="step-result">
                                é€£çµåŸºé‡‘Aé¡ ç¸½äº¤æ˜“æˆæœ¬ï¼š0å…ƒ
                            </div>
                        </div>
                    </div>
                </div>
                
                <div style="margin: 30px 0;">
                    <h4 class="collapsible-header" onclick="toggleCollapse('transactionCostTableContent')" style="color: #2c3e50; margin: 0 0 20px 0; font-size: 1.4em; border-bottom: 3px solid #e74c3c; padding-bottom: 10px; cursor: pointer; user-select: none; position: relative; padding-right: 30px;">
                        ğŸ’¸ äº¤æ˜“æˆæœ¬æ¯”è¼ƒè¡¨æ ¼ <span class="collapse-icon">â–¼</span>
                    </h4>
                    <div id="transactionCostTableContent" class="collapsible-content">
                        <div class="table-container">
                            <table class="comparison-table">
                                <thead>
                                    <tr>
                                        <th>æˆæœ¬é …ç›®</th>
                                        <th>0050 ETF</th>
                                        <th>é€£çµåŸºé‡‘Aé¡</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>ç”³è³¼æ‰‹çºŒè²»</td>
                                        <td>${Math.round(results.transactionCosts.etf.buyFees).toLocaleString()}å…ƒ</td>
                                        <td>0å…ƒ</td>
                                    </tr>
                                    <tr>
                                        <td>è´–å›æ‰‹çºŒè²»</td>
                                        <td>${Math.round(results.transactionCosts.etf.sellFees).toLocaleString()}å…ƒ</td>
                                        <td>0å…ƒ</td>
                                    </tr>
                                    <tr>
                                        <td>è­‰äº¤ç¨…</td>
                                        <td>${Math.round(results.transactionCosts.etf.tax).toLocaleString()}å…ƒ</td>
                                        <td>0å…ƒ</td>
                                    </tr>
                                    <tr style="font-weight: bold; background: #f8f9fa;">
                                        <td>ç¸½äº¤æ˜“æˆæœ¬</td>
                                        <td>${Math.round(results.transactionCosts.etf.total).toLocaleString()}å…ƒ</td>
                                        <td>0å…ƒ</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                
                <div style="margin: 30px 0;">
                    <h4 style="color: #2c3e50; margin: 0 0 20px 0; font-size: 1.4em; border-bottom: 3px solid #e74c3c; padding-bottom: 10px;">ğŸ¯ äº¤æ˜“æˆæœ¬é‡é»æ¯”è¼ƒ</h4>
                    <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 30px; border-radius: 15px; margin: 20px 0;">
                        <div class="grid-2-cols" style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px; align-items: center;">
                            <div style="text-align: center;">
                                <h4 style="color: white; margin: 0 0 15px 0; font-size: 1.3em;">ğŸ¦ 0050 ETF</h4>
                                <div style="background: rgba(255,255,255,0.2); padding: 20px; border-radius: 10px;">
                                    <div style="font-size: 0.9em; opacity: 0.9; margin-bottom: 8px;">${results.inputs.investmentYears}å¹´ç¸½äº¤æ˜“æˆæœ¬</div>
                                    <div style="font-size: 2.2em; font-weight: bold; color: #ffeb3b;">${Math.round(results.transactionCosts.etf.total).toLocaleString()}å…ƒ</div>
                                </div>
                            </div>
                            <div style="text-align: center;">
                                <h4 style="color: white; margin: 0 0 15px 0; font-size: 1.3em;">ğŸ”— é€£çµåŸºé‡‘Aé¡</h4>
                                <div style="background: rgba(255,255,255,0.2); padding: 20px; border-radius: 10px;">
                                    <div style="font-size: 0.9em; opacity: 0.9; margin-bottom: 8px;">${results.inputs.investmentYears}å¹´ç¸½äº¤æ˜“æˆæœ¬</div>
                                    <div style="font-size: 2.2em; font-weight: bold; color: #4caf50;">0å…ƒ</div>
                                </div>
                            </div>
                        </div>
                        
                        <div style="text-align: center; margin-top: 25px; padding-top: 25px; border-top: 2px solid rgba(255,255,255,0.3);">
                            <div style="font-size: 1.1em; margin-bottom: 10px;">ğŸ’° äº¤æ˜“æˆæœ¬å·®ç•°</div>
                            <div style="font-size: 2.5em; font-weight: bold; color: #4caf50;">
                                ${Math.round(results.transactionCosts.etf.total).toLocaleString()}å…ƒ
                            </div>
                            <div style="font-size: 1em; opacity: 0.9; margin-top: 8px;">
                                é¸æ“‡é€£çµåŸºé‡‘Aé¡å¯ç¯€çœäº¤æ˜“æˆæœ¬
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // é¡¯ç¤ºç¨…å‹™æˆæœ¬è©³ç´°è¨ˆç®—
        function displayTaxCostsCalculation(results) {
            const calculationDiv = document.getElementById('taxCostsCalculation');
            const inputs = results.inputs;
            const netTaxCost = results.taxAnalysis.actualTax - results.taxAnalysis.refund;
            
            calculationDiv.innerHTML = `
                <div class="calculation-section">
                    <div class="calculation-section-header" onclick="toggleCalculationSection('etfTaxCalculationContent')">
                        <h4>ğŸ¦ 0050 ETF ç¨…å‹™æˆæœ¬è©³ç´°è¨ˆç®— <span class="collapse-icon">â–¼</span></h4>
                    </div>
                    <div id="etfTaxCalculationContent" class="calculation-section-content">
                        <div class="calculation-step">
                            <h4>ğŸ§¾ é…æ¯é‡‘é¡ä¼°ç®—</h4>
                            <div class="formula">
                                æŠ•è³‡åƒæ•¸ï¼š<br>
                                â€¢ å¹´é…æ¯ç‡ï¼š${inputs.dividendYield}%<br>
                                â€¢ æŠ•è³‡æœŸé–“ï¼š${inputs.investmentYears}å¹´<br>
                                â€¢ ç´¯ç©è³‡ç”¢è®ŠåŒ–ï¼šéš¨æŠ•è³‡æ™‚é–“éå¢<br><br>
                                
                                è¨ˆç®—é‚è¼¯ï¼š<br>
                                æ¯å¹´æ ¹æ“šç•¶å¹´åº•ç´¯ç©è³‡ç”¢è¨ˆç®—é…æ¯<br>
                                ç¸½é…æ¯ = Î£(å„å¹´åº¦è³‡ç”¢ Ã— å¹´é…æ¯ç‡)
                            </div>
                            <div class="step-result">
                                ${inputs.investmentYears}å¹´ç¸½é…æ¯ï¼š${Math.round(results.taxAnalysis.totalDividend).toLocaleString()}å…ƒ
                            </div>
                        </div>
                        
                        <div class="calculation-step">
                            <h4>ğŸ§¾ 54Cèª²ç¨…é‡‘é¡è¨ˆç®—</h4>
                            <div class="formula">
                                èª²ç¨…è¦å‰‡ï¼ˆ54Cæ¢æ¬¾ï¼‰ï¼š<br>
                                â€¢ ç¸½é…æ¯é‡‘é¡ï¼š${Math.round(results.taxAnalysis.totalDividend).toLocaleString()}å…ƒ<br>
                                â€¢ 54Cèª²ç¨…æ¯”ä¾‹ï¼š${inputs.taxableRatio}%<br>
                                â€¢ å…ç¨…éƒ¨åˆ†ï¼š${100 - inputs.taxableRatio}%<br><br>
                                
                                è¨ˆç®—éç¨‹ï¼š<br>
                                éœ€èª²ç¨…é‡‘é¡ = ${Math.round(results.taxAnalysis.totalDividend).toLocaleString()}å…ƒ Ã— ${inputs.taxableRatio}% = ${Math.round(results.taxAnalysis.totalTaxable).toLocaleString()}å…ƒ
                            </div>
                            <div class="step-result">
                                èª²ç¨…é‡‘é¡ï¼š${Math.round(results.taxAnalysis.totalTaxable).toLocaleString()}å…ƒ
                            </div>
                        </div>
                        
                        <div class="calculation-step">
                            <h4>ğŸ§¾ æ‡‰ç´ç¨…é¡è¨ˆç®—</h4>
                            <div class="formula">
                                å€‹äººç¶œåˆæ‰€å¾—ç¨…ï¼š<br>
                                â€¢ èª²ç¨…é‡‘é¡ï¼š${Math.round(results.taxAnalysis.totalTaxable).toLocaleString()}å…ƒ<br>
                                â€¢ é©ç”¨ç¨…ç‡ï¼š${inputs.personalTaxRate}%<br>
                                â€¢ è¨ˆç®—åŸºç¤ï¼šä½µå…¥å¹´åº¦ç¶œåˆæ‰€å¾—<br><br>
                                
                                è¨ˆç®—éç¨‹ï¼š<br>
                                æ‡‰ç´ç¨…é¡ = ${Math.round(results.taxAnalysis.totalTaxable).toLocaleString()}å…ƒ Ã— ${inputs.personalTaxRate}% = ${Math.round(results.taxAnalysis.taxOwed).toLocaleString()}å…ƒ
                            </div>
                            <div class="step-result">
                                æ‡‰ç´ç¨…é¡ï¼š${Math.round(results.taxAnalysis.taxOwed).toLocaleString()}å…ƒ
                            </div>
                        </div>
                        
                        <div class="calculation-step">
                            <h4>ğŸ§¾ å¯æŠµæ¸›ç¨…é¡è¨ˆç®—</h4>
                            <div class="formula">
                                è‚¡åˆ©ç¨…é¡æ‰£æŠµï¼š<br>
                                â€¢ èª²ç¨…é‡‘é¡ï¼š${Math.round(results.taxAnalysis.totalTaxable).toLocaleString()}å…ƒ<br>
                                â€¢ æŠµæ¸›ç¨…é¡ç‡ï¼š8.5%<br>
                                â€¢ ä¸Šé™ï¼š8è¬å…ƒ/å¹´ï¼ˆå€‹äººï¼‰<br><br>
                                
                                è¨ˆç®—éç¨‹ï¼š<br>
                                å¯æŠµæ¸›ç¨…é¡ = ${Math.round(results.taxAnalysis.totalTaxable).toLocaleString()}å…ƒ Ã— 8.5% = ${Math.round(results.taxAnalysis.taxCredit).toLocaleString()}å…ƒ
                            </div>
                            <div class="step-result">
                                å¯æŠµæ¸›ç¨…é¡ï¼š${Math.round(results.taxAnalysis.taxCredit).toLocaleString()}å…ƒ
                            </div>
                        </div>
                        
                        <div class="calculation-step">
                            <h4>ğŸ§¾ å¯¦éš›ç¨…è² è¨ˆç®—</h4>
                            <div class="formula">
                                æœ€çµ‚ç¨…è² ï¼š<br>
                                â€¢ æ‡‰ç´ç¨…é¡ï¼š${Math.round(results.taxAnalysis.taxOwed).toLocaleString()}å…ƒ<br>
                                â€¢ å¯æŠµæ¸›ç¨…é¡ï¼š${Math.round(results.taxAnalysis.taxCredit).toLocaleString()}å…ƒ<br><br>
                                
                                è¨ˆç®—éç¨‹ï¼š<br>
                                å¯¦éš›ç¨…è²  = æ‡‰ç´ç¨…é¡ - å¯æŠµæ¸›ç¨…é¡<br>
                                = ${Math.round(results.taxAnalysis.taxOwed).toLocaleString()}å…ƒ - ${Math.round(results.taxAnalysis.taxCredit).toLocaleString()}å…ƒ = ${Math.round(netTaxCost).toLocaleString()}å…ƒ
                                ${results.taxAnalysis.refund > 0 ? `<br><br>â€» å¯æŠµæ¸›ç¨…é¡è¶…éæ‡‰ç´ç¨…é¡ï¼Œå¯é€€ç¨…ï¼š${Math.round(results.taxAnalysis.refund).toLocaleString()}å…ƒ` : ''}
                            </div>
                            <div class="step-result">
                                å¯¦éš›ç¨…è² ï¼š${netTaxCost >= 0 ? Math.round(netTaxCost).toLocaleString() + 'å…ƒ' : 'é€€ç¨…' + Math.round(-netTaxCost).toLocaleString() + 'å…ƒ'}
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="calculation-section">
                    <div class="calculation-section-header" onclick="toggleCalculationSection('linkTaxCalculationContent')">
                        <h4>ğŸ”— é€£çµåŸºé‡‘Aé¡ ç¨…å‹™æˆæœ¬è©³ç´°è¨ˆç®— <span class="collapse-icon">â–¼</span></h4>
                    </div>
                    <div id="linkTaxCalculationContent" class="calculation-section-content">
                        <div class="calculation-step">
                            <h4>ğŸ§¾ åŸºé‡‘é¡å‹ç‰¹æ€§</h4>
                            <div class="formula">
                                ç´¯ç©å‹åŸºé‡‘ç‰¹æ€§ï¼š<br>
                                â€¢ ä¸é€²è¡Œé…æ¯ï¼šå°‡æ”¶ç›Šè‡ªå‹•å†æŠ•è³‡<br>
                                â€¢ è¤‡åˆ©æˆé•·ï¼šæ”¶ç›Šè½‰ç‚ºåŸºé‡‘æ·¨å€¼å¢é•·<br>
                                â€¢ ç„¡è‚¡åˆ©æ‰€å¾—ï¼šä¸ç”¢ç”Ÿæ‡‰ç¨…æ‰€å¾—<br>
                                â€¢ è³‡æœ¬åˆ©å¾—ï¼šæŒæœ‰æœŸé–“å…ç¨…
                            </div>
                            <div class="step-result">
                                æŠ•è³‡æœŸé–“ç¨…å‹™è² æ“”ï¼š0å…ƒ
                            </div>
                        </div>
                        
                        <div class="calculation-step">
                            <h4>ğŸ§¾ è´–å›æ™‚ç¨…å‹™è™•ç†</h4>
                            <div class="formula">
                                è´–å›æ™‚ç¨…å‹™ï¼š<br>
                                â€¢ åŸºé‡‘äº¤æ˜“æ‰€å¾—ï¼šç›®å‰å…èª²è­‰æ‰€ç¨…<br>
                                â€¢ ç„¡æœ€ä½ç¨…è² ï¼šä¸€èˆ¬æŠ•è³‡äººé©ç”¨<br>
                                â€¢ ç„¡äºŒä»£å¥ä¿ï¼šåŸºé‡‘äº¤æ˜“å…èª²<br>
                                â€¢ å®Œå…¨å…ç¨…ï¼šç„¡ä»»ä½•ç¨…å‹™è² æ“”
                            </div>
                            <div class="step-result">
                                è´–å›æ™‚ç¨…å‹™è² æ“”ï¼š0å…ƒ
                            </div>
                        </div>
                        
                        <div class="calculation-step">
                            <h4>ğŸ“Š é€£çµåŸºé‡‘Aé¡ ç¨…å‹™æˆæœ¬ç¸½è¨ˆ</h4>
                            <div class="formula">
                                ç¸½ç¨…å‹™æˆæœ¬ = æŠ•è³‡æœŸé–“ç¨…è²  + è´–å›æ™‚ç¨…è² <br>
                                = 0å…ƒ + 0å…ƒ
                            </div>
                            <div class="step-result">
                                é€£çµåŸºé‡‘Aé¡ ç¸½ç¨…å‹™æˆæœ¬ï¼š0å…ƒ
                            </div>
                        </div>
                    </div>
                </div>
                
                <div style="margin: 30px 0;">
                    <h4 class="collapsible-header" onclick="toggleCollapse('taxCostTableContent')" style="color: #2c3e50; margin: 0 0 20px 0; font-size: 1.4em; border-bottom: 3px solid #f39c12; padding-bottom: 10px; cursor: pointer; user-select: none; position: relative; padding-right: 30px;">
                        ğŸ§¾ ç¨…å‹™æˆæœ¬æ¯”è¼ƒè¡¨æ ¼ <span class="collapse-icon">â–¼</span>
                    </h4>
                    <div id="taxCostTableContent" class="collapsible-content">
                        <div class="table-container">
                            <table class="comparison-table">
                                <thead>
                                    <tr>
                                        <th>ç¨…å‹™é …ç›®</th>
                                        <th>0050 ETF</th>
                                        <th>é€£çµåŸºé‡‘Aé¡</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>ç¸½é…æ¯é‡‘é¡</td>
                                        <td>${Math.round(results.taxAnalysis.totalDividend).toLocaleString()}å…ƒ</td>
                                        <td>0å…ƒï¼ˆç„¡é…æ¯ï¼‰</td>
                                    </tr>
                                    <tr>
                                        <td>éœ€èª²ç¨…é‡‘é¡</td>
                                        <td>${Math.round(results.taxAnalysis.totalTaxable).toLocaleString()}å…ƒ</td>
                                        <td>0å…ƒ</td>
                                    </tr>
                                    <tr>
                                        <td>æ‡‰ç´ç¨…é¡</td>
                                        <td>${Math.round(results.taxAnalysis.taxOwed).toLocaleString()}å…ƒ</td>
                                        <td>0å…ƒ</td>
                                    </tr>
                                    <tr>
                                        <td>å¯æŠµæ¸›ç¨…é¡</td>
                                        <td>${Math.round(results.taxAnalysis.taxCredit).toLocaleString()}å…ƒ</td>
                                        <td>0å…ƒ</td>
                                    </tr>
                                    <tr style="font-weight: bold; background: #f8f9fa;">
                                        <td>å¯¦éš›ç¨…å‹™æˆæœ¬</td>
                                        <td>${(results.taxAnalysis.actualTax - results.taxAnalysis.refund) >= 0 ? Math.round(results.taxAnalysis.actualTax - results.taxAnalysis.refund).toLocaleString() + 'å…ƒ' : 'é€€ç¨…' + Math.round(-(results.taxAnalysis.actualTax - results.taxAnalysis.refund)).toLocaleString() + 'å…ƒ'}</td>
                                        <td>0å…ƒ</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                
                <div style="margin: 30px 0;">
                    <h4 style="color: #2c3e50; margin: 0 0 20px 0; font-size: 1.4em; border-bottom: 3px solid #f39c12; padding-bottom: 10px;">ğŸ¯ ç¨…å‹™æˆæœ¬å·®ç•°åˆ†æ</h4>
                    <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 30px; border-radius: 15px; margin: 20px 0;">
                        <div class="grid-2-cols" style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px; align-items: center;">
                            <div style="text-align: center;">
                                <h4 style="color: white; margin: 0 0 15px 0; font-size: 1.3em;">ğŸ¦ 0050 ETF</h4>
                                <div style="background: rgba(255,255,255,0.2); padding: 20px; border-radius: 10px;">
                                    <div style="font-size: 0.9em; opacity: 0.9; margin-bottom: 8px;">${results.inputs.investmentYears}å¹´ç¸½ç¨…å‹™æˆæœ¬</div>
                                    <div style="font-size: 2.2em; font-weight: bold; color: ${netTaxCost >= 0 ? '#ffeb3b' : '#4caf50'};">
                                        ${netTaxCost >= 0 ? Math.round(netTaxCost).toLocaleString() + 'å…ƒ' : 'é€€ç¨…' + Math.round(-netTaxCost).toLocaleString() + 'å…ƒ'}
                                    </div>
                                </div>
                            </div>
                            <div style="text-align: center;">
                                <h4 style="color: white; margin: 0 0 15px 0; font-size: 1.3em;">ğŸ”— é€£çµåŸºé‡‘Aé¡</h4>
                                <div style="background: rgba(255,255,255,0.2); padding: 20px; border-radius: 10px;">
                                    <div style="font-size: 0.9em; opacity: 0.9; margin-bottom: 8px;">${results.inputs.investmentYears}å¹´ç¸½ç¨…å‹™æˆæœ¬</div>
                                    <div style="font-size: 2.2em; font-weight: bold; color: #4caf50;">0å…ƒ</div>
                                </div>
                            </div>
                        </div>
                        
                        <div style="text-align: center; margin-top: 25px; padding-top: 25px; border-top: 2px solid rgba(255,255,255,0.3);">
                            <div style="font-size: 1.1em; margin-bottom: 10px;">ğŸ’° ç¨…å‹™æˆæœ¬å·®ç•°</div>
                            <div style="font-size: 2.5em; font-weight: bold; color: ${netTaxCost >= 0 ? '#4caf50' : '#ffeb3b'};">
                                ${netTaxCost >= 0 ? Math.round(netTaxCost).toLocaleString() + 'å…ƒ' : Math.round(-netTaxCost).toLocaleString() + 'å…ƒ'}
                            </div>
                            <div style="font-size: 1em; opacity: 0.9; margin-top: 8px;">
                                ${netTaxCost >= 0 ? 
                                    'é¸æ“‡é€£çµåŸºé‡‘Aé¡å¯ç¯€çœç¨…å‹™æˆæœ¬' :
                                    '0050 ETFæœ‰é€€ç¨…å„ªå‹¢'
                                }
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // é¡¯ç¤ºçµæœï¼ˆä¸»å‡½æ•¸ï¼‰
        function displayResults(results) {
            displayFeeRules();
            displayCalculationProcess(results);
            displayTransactionCostsCalculation(results);
            displayTaxCostsCalculation(results);
            
            // å¡«å……å…¶ä»–è¡¨æ ¼æ•¸æ“š
            fillTotalComparison(results);
            fillInvestmentAdvice(results);
        }

        // å¡«å……ç¸½æˆæœ¬æ¯”è¼ƒ
        function fillTotalComparison(results) {
            const totalDiv = document.getElementById('totalComparison');
            if (!totalDiv) return;
            
            const savings = results.totalCosts.etf - results.totalCosts.link;
            const averageAssets = results.finalAmount * 0.6; // ç°¡åŒ–ä¼°ç®—
            
            totalDiv.innerHTML = `
                <div class="calculation-section">
                    <div class="calculation-section-header" onclick="toggleCalculationSection('internalFeesMethodContent')">
                        <h4>ğŸ’° å…§æ‰£è²»ç”¨è¨ˆç®—æ–¹å¼èªªæ˜ <span class="collapse-icon">â–¼</span></h4>
                    </div>
                    <div id="internalFeesMethodContent" class="calculation-section-content">
                        <div class="calculation-step">
                            <h4>ğŸ“ˆ å¹³å‡è³‡ç”¢ä¼°ç®—</h4>
                            <div class="formula">
                                è¨ˆç®—é‚è¼¯ï¼š<br>
                                â€¢ æœ€çµ‚è³‡ç”¢ï¼š${Math.round(results.finalAmount).toLocaleString()}å…ƒ<br>
                                â€¢ ä¼°ç®—ä¿‚æ•¸ï¼š60%ï¼ˆç°¡åŒ–ä¼°ç®—ï¼Œè€ƒæ…®å®šæœŸå®šé¡ç‰¹æ€§ï¼‰<br>
                                â€¢ è¨ˆç®—åŸç†ï¼šå®šæœŸå®šé¡æŠ•è³‡éç¨‹ä¸­ï¼Œè³‡ç”¢é€æ­¥ç´¯ç©ï¼Œå¹³å‡æŒæœ‰è³‡ç”¢ç´„ç‚ºæœ€çµ‚è³‡ç”¢çš„60%<br><br>
                                
                                å¹³å‡è³‡ç”¢ = æœ€çµ‚è³‡ç”¢ Ã— 60%<br>
                                = ${Math.round(results.finalAmount).toLocaleString()}å…ƒ Ã— 60% = ${Math.round(averageAssets).toLocaleString()}å…ƒ
                            </div>
                            <div class="step-result">
                                ç”¨æ–¼è¨ˆç®—å…§æ‰£è²»ç”¨çš„å¹³å‡è³‡ç”¢ï¼š${Math.round(averageAssets).toLocaleString()}å…ƒ
                            </div>
                        </div>
                        
                        <div class="calculation-step">
                            <h4>ğŸ¦ 0050 ETF å…§æ‰£è²»ç”¨è¨ˆç®—</h4>
                            <div class="formula">
                                è¨ˆç®—éç¨‹ï¼š<br>
                                â€¢ å¹³å‡è³‡ç”¢ï¼š${Math.round(averageAssets).toLocaleString()}å…ƒ<br>
                                â€¢ ç¸½è²»ç”¨ç‡ï¼š${results.fees.etf.total.toFixed(4)}%<br>
                                â€¢ æŠ•è³‡æœŸé–“ï¼š${results.inputs.investmentYears}å¹´<br><br>
                                
                                å…§æ‰£è²»ç”¨ = å¹³å‡è³‡ç”¢ Ã— ç¸½è²»ç”¨ç‡ Ã— æŠ•è³‡æœŸé–“<br>
                                = ${Math.round(averageAssets).toLocaleString()}å…ƒ Ã— ${results.fees.etf.total.toFixed(4)}% Ã— ${results.inputs.investmentYears}å¹´<br>
                                = ${Math.round(results.internalFees.etf).toLocaleString()}å…ƒ
                            </div>
                            <div class="step-result">
                                0050 ETF ${results.inputs.investmentYears}å¹´ç¸½å…§æ‰£è²»ç”¨ï¼š${Math.round(results.internalFees.etf).toLocaleString()}å…ƒ
                            </div>
                        </div>
                        
                        <div class="calculation-step">
                            <h4>ğŸ”— é€£çµåŸºé‡‘Aé¡ å…§æ‰£è²»ç”¨è¨ˆç®—</h4>
                            <div class="formula">
                                è¨ˆç®—éç¨‹ï¼š<br>
                                â€¢ å¹³å‡è³‡ç”¢ï¼š${Math.round(averageAssets).toLocaleString()}å…ƒ<br>
                                â€¢ ç¸½è²»ç”¨ç‡ï¼š${results.fees.link.total.toFixed(4)}%<br>
                                â€¢ æŠ•è³‡æœŸé–“ï¼š${results.inputs.investmentYears}å¹´<br><br>
                                
                                å…§æ‰£è²»ç”¨ = å¹³å‡è³‡ç”¢ Ã— ç¸½è²»ç”¨ç‡ Ã— æŠ•è³‡æœŸé–“<br>
                                = ${Math.round(averageAssets).toLocaleString()}å…ƒ Ã— ${results.fees.link.total.toFixed(4)}% Ã— ${results.inputs.investmentYears}å¹´<br>
                                = ${Math.round(results.internalFees.link).toLocaleString()}å…ƒ
                            </div>
                            <div class="step-result">
                                é€£çµåŸºé‡‘Aé¡ ${results.inputs.investmentYears}å¹´ç¸½å…§æ‰£è²»ç”¨ï¼š${Math.round(results.internalFees.link).toLocaleString()}å…ƒ
                            </div>
                        </div>
                        
                        <div class="calculation-step">
                            <h4>ğŸ“Š å…§æ‰£è²»ç”¨å·®ç•°</h4>
                            <div class="formula">
                                è²»ç”¨å·®ç•°è¨ˆç®—ï¼š<br>
                                å…§æ‰£è²»ç”¨å·®ç•° = 0050 ETFå…§æ‰£è²»ç”¨ - é€£çµåŸºé‡‘Aé¡å…§æ‰£è²»ç”¨<br>
                                = ${Math.round(results.internalFees.etf).toLocaleString()}å…ƒ - ${Math.round(results.internalFees.link).toLocaleString()}å…ƒ<br>
                                = ${Math.round(results.internalFees.etf - results.internalFees.link).toLocaleString()}å…ƒ
                            </div>
                            <div class="step-result">
                                ${results.internalFees.etf > results.internalFees.link ? 
                                    `é¸æ“‡é€£çµåŸºé‡‘Aé¡å¯ç¯€çœå…§æ‰£è²»ç”¨ï¼š${Math.round(results.internalFees.etf - results.internalFees.link).toLocaleString()}å…ƒ` :
                                    `é¸æ“‡0050 ETFå¯ç¯€çœå…§æ‰£è²»ç”¨ï¼š${Math.round(results.internalFees.link - results.internalFees.etf).toLocaleString()}å…ƒ`
                                }
                            </div>
                        </div>
                    </div>
                </div>
                
                <div style="margin: 30px 0;">
                    <h4 style="color: #2c3e50; margin: 0 0 20px 0; font-size: 1.4em; border-bottom: 3px solid #3498db; padding-bottom: 10px;">ğŸ“‹ ç¸½æˆæœ¬è©³ç´°æ¯”è¼ƒ</h4>
                    <div class="table-container">
                        <table class="comparison-table">
                            <thead>
                                <tr>
                                    <th>æˆæœ¬é …ç›®</th>
                                    <th>0050 ETF</th>
                                    <th>é€£çµåŸºé‡‘Aé¡</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>å…§æ‰£è²»ç”¨</td>
                                    <td>${Math.round(results.internalFees.etf).toLocaleString()}å…ƒ</td>
                                    <td>${Math.round(results.internalFees.link).toLocaleString()}å…ƒ</td>
                                </tr>
                                <tr>
                                    <td>äº¤æ˜“æˆæœ¬</td>
                                    <td>${Math.round(results.transactionCosts.etf.total).toLocaleString()}å…ƒ</td>
                                    <td>0å…ƒ</td>
                                </tr>
                                <tr>
                                    <td>ç¨…å‹™æˆæœ¬</td>
                                    <td>${Math.round(results.taxAnalysis.actualTax - results.taxAnalysis.refund).toLocaleString()}å…ƒ</td>
                                    <td>0å…ƒ</td>
                                </tr>
                                <tr style="font-weight: bold; font-size: 1.1em; background: #f8f9fa;">
                                    <td>ç¸½æˆæœ¬</td>
                                    <td class="${savings > 0 ? 'negative' : 'winner'}">${Math.round(results.totalCosts.etf).toLocaleString()}å…ƒ</td>
                                    <td class="${savings > 0 ? 'winner' : 'negative'}">${Math.round(results.totalCosts.link).toLocaleString()}å…ƒ</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <div class="highlight">
                    ${savings > 0 ? 
                        `é¸æ“‡é€£çµåŸºé‡‘Aé¡å¯ç¯€çœï¼š<span class="positive">${Math.round(savings).toLocaleString()}å…ƒ</span><br>ç¯€çœæ¯”ä¾‹ï¼š<span class="positive">${(savings/results.totalCosts.etf*100).toFixed(1)}%</span>` :
                        `é¸æ“‡0050 ETFå¯ç¯€çœï¼š<span class="positive">${Math.round(-savings).toLocaleString()}å…ƒ</span><br>ç¯€çœæ¯”ä¾‹ï¼š<span class="positive">${(-savings/results.totalCosts.link*100).toFixed(1)}%</span>`
                    }
                </div>
            `;
        }

        // å¡«å……æŠ•è³‡å»ºè­°
        function fillInvestmentAdvice(results) {
            const adviceDiv = document.getElementById('investmentAdvice');
            if (!adviceDiv) return;
            
            const savings = results.totalCosts.etf - results.totalCosts.link;
            let recommendation = '';
            
            if (savings > 1000) {
                recommendation = `
                    <div style="background: #d4edda; padding: 20px; border-radius: 10px; margin-bottom: 15px;">
                        <h4 style="color: #155724; margin-top: 0;">ğŸ“ˆ å¼·çƒˆå»ºè­°é¸æ“‡é€£çµåŸºé‡‘Aé¡</h4>
                        <p>å¯ç¯€çœ <strong>${Math.round(savings).toLocaleString()}å…ƒ</strong>ï¼Œç¯€çœæ•ˆæœé¡¯è‘—ã€‚</p>
                    </div>
                `;
            } else if (savings > 0) {
                recommendation = `
                    <div style="background: #fff3cd; padding: 20px; border-radius: 10px; margin-bottom: 15px;">
                        <h4 style="color: #856404; margin-top: 0;">âš–ï¸ å»ºè­°é¸æ“‡é€£çµåŸºé‡‘Aé¡</h4>
                        <p>å¯ç¯€çœ <strong>${Math.round(savings).toLocaleString()}å…ƒ</strong>ã€‚</p>
                    </div>
                `;
            } else if (savings < -1000) {
                recommendation = `
                    <div style="background: #d4edda; padding: 20px; border-radius: 10px; margin-bottom: 15px;">
                        <h4 style="color: #155724; margin-top: 0;">ğŸ“Š å¼·çƒˆå»ºè­°é¸æ“‡0050 ETF</h4>
                        <p>å¯ç¯€çœ <strong>${Math.round(-savings).toLocaleString()}å…ƒ</strong>ï¼Œç¯€çœæ•ˆæœé¡¯è‘—ã€‚</p>
                    </div>
                `;
            } else {
                recommendation = `
                    <div style="background: #f8d7da; padding: 20px; border-radius: 10px; margin-bottom: 15px;">
                        <h4 style="color: #721c24; margin-top: 0;">âš–ï¸ å…©è€…æˆæœ¬ç›¸ç•¶</h4>
                        <p>å¯ä¾å€‹äººåå¥½é¸æ“‡ï¼Œå·®ç•°è¼ƒå°ã€‚</p>
                    </div>
                `;
            }
            
            adviceDiv.innerHTML = recommendation + `
                <h4>ğŸ’¡ é—œéµè€ƒé‡å› ç´ ï¼š</h4>
                <ul style="line-height: 1.8;">
                    <li><strong>æŠ•è³‡é‡‘é¡ï¼š</strong>æ¯æœˆ${results.inputs.monthlyInvestment.toLocaleString()}å…ƒï¼Œ${results.inputs.monthlyInvestment <= 5000 ? 'é©åˆé€£çµåŸºé‡‘çš„å°é¡æŠ•è³‡å„ªå‹¢' : 'å…©ç¨®ç”¢å“éƒ½é©åˆ'}</li>
                    <li><strong>ç¨…ç‡å½±éŸ¿ï¼š</strong>${results.inputs.personalTaxRate}%ç¨…ç‡${results.inputs.personalTaxRate >= 12 ? 'ï¼Œé€£çµåŸºé‡‘å…ç¨…å„ªå‹¢æ˜é¡¯' : 'ï¼Œç¨…å‹™å„ªå‹¢æœ‰é™'}</li>
                    <li><strong>é…æ¯åå¥½ï¼š</strong>0050æä¾›${results.inputs.dividendYield}%ç¾é‡‘é…æ¯ï¼Œé€£çµåŸºé‡‘æ¡ç´¯ç©è¤‡åˆ©</li>
                    <li><strong>æŠ•è³‡ä¾¿åˆ©æ€§ï¼š</strong>é€£çµåŸºé‡‘äº¤æ˜“æ›´ä¾¿åˆ©ï¼Œç„¡éœ€è­‰åˆ¸å¸³æˆ¶</li>
                    <li><strong>æŠ•è³‡æœŸé–“ï¼š</strong>${results.inputs.investmentYears}å¹´æŠ•è³‡æœŸé–“${results.inputs.investmentYears >= 10 ? 'è¼ƒé•·ï¼Œå…§æ‰£è²»ç”¨å·®ç•°æœƒæ”¾å¤§' : 'ï¼ŒçŸ­æœŸå·®ç•°è¼ƒå°'}</li>
                </ul>
            `;
        }

        // æ·»åŠ å³æ™‚é©—è­‰
        document.addEventListener('DOMContentLoaded', function() {
            // ç‚ºæ‰€æœ‰è¼¸å…¥æ¬„ä½æ·»åŠ å³æ™‚é©—è­‰
            document.querySelectorAll('input[type="number"]').forEach(input => {
                input.addEventListener('input', function() {
                    this.classList.remove('error');
                    UIController.hideError();
                });
                
                input.addEventListener('blur', function() {
                    const inputs = getInputValues();
                    const errors = InputValidator.validate(inputs);
                    InputValidator.highlightErrors(inputs, errors);
                });
            });
            
            // åˆå§‹è¨ˆç®—
            handleCalculation();
        });

    </script>
</body>
</html>
